<!DOCTYPE html><!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Tue Nov 09 2021 23:13:34 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="6116d043a50c2707ea071f39" data-wf-site="6116d043a50c27b121071f38">
<head>
  <meta charset="utf-8">
  <title>NotebookStories</title>
  <meta content="A tool to reimagine notebooks" name="description">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="css/normalize.css" rel="stylesheet" type="text/css">
  <link href="css/houseprice.css" rel="stylesheet" type="text/css">
  <link href="css/webflow.css" rel="stylesheet" type="text/css">
  <link href="css/story-telling-notebook.webflow.css" rel="stylesheet" type="text/css">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["Montserrat:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic","Lato:100,100italic,300,300italic,400,400italic,700,700italic,900,900italic"]  }});</script>
  <!-- [if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif] -->
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="images/porpoise3.png" rel="shortcut icon" type="image/x-icon">
  <link href="images/webclip.png" rel="apple-touch-icon">

  <!-- Load mathjax -->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML-full,Safe"> </script>
      <!-- MathJax configuration -->
      <script type="text/x-mathjax-config">
      init_mathjax = function() {
          if (window.MathJax) {
          // MathJax loaded
              MathJax.Hub.Config({
                  TeX: {
                      equationNumbers: {
                      autoNumber: "AMS",
                      useLabelIds: true
                      }
                  },
                  tex2jax: {
                      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                      processEscapes: true,
                      processEnvironments: true
                  },
                  displayAlign: 'center',
                  CommonHTML: {
                      linebreaks: {
                      automatic: true
                      }
                  },
                  "HTML-CSS": {
                      linebreaks: {
                      automatic: true
                      }
                  }
              });

              MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
          }
      }
      init_mathjax();
      </script>

</head>
<body class="body">
  <div data-collapse="medium" data-animation="default" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="navbar w-nav">
    <div class="topmatter"><img src="images/NB_nav_topMatter_menuonly.png" loading="lazy" alt="" class="topmatter"></div>
  </div>
  <div class="main">
    <div class="maindivider w-row">

      <!-- The side menu stuff -->
      <div class="sidebar w-col w-col-3">
        <div class="div-block-5"><img src="images/NB_side_topmatter.png" loading="lazy" width="560" alt="" class="image-3"></div>
        <ol role="list" class="list-2">


          <li class="chapterhandles">
            <a href="#chapter-1" data-w-id="8a33913e-c4eb-46be-aba8-ab27009e82d3" class="chapterhandle w-inline-block">
                <div class="w-layout-grid grid-4">
                    <h4 class="chaptertitle">Exploratory Visualization</h4>
                    <div>
                        <div class="tooltip"><img src="images/library.png" loading="lazy" alt="" class="icon"><span class="tooltiptext">Library</span></div>
                        <div class="tooltip"><img src="images/graph.png" loading="lazy" alt="" class="icon"><span class="tooltiptext">Graph</span></div>
                        <div class="tooltip"><img src="images/data.png" loading="lazy" sizes="20px" srcset="images/data-p-500.png 500w, images/data.png 512w" alt="" class="icon"><span class="tooltiptext">Data</span></div>
                    </div>
                        <h3 id="w-node-e2cac0ae-dd0e-798a-652d-9287b04afd63-ea071f39" class="pagenumber">1 - 4 <br/> 7 - 13</h3>
                </div>
            </a>
          </li>
          <li class="chapterhandles">
            <a href="#chapter-2" data-w-id="b2117bcb-3f16-0907-2c24-1d7829649a8f" class="chapterhandle w-inline-block">
              <div class="w-layout-grid grid-4">
                <h3 class="chaptertitle">Data Cleaning</h3>
                <div>
                  <div class="tooltip"><img src="images/library.png" loading="lazy" alt="" class="icon"><span class="tooltiptext">Library</span></div>
                  <div class="tooltip"><img src="images/graph.png" loading="lazy" alt="" class="icon"><span class="tooltiptext">Graph</span></div>
                  <div class="tooltip"><img src="images/table.png" loading="lazy" alt="" class="icon"><span class="tooltiptext">Table</span></div>
                  <div class="tooltip"><img src="images/data.png" loading="lazy" sizes="20px" srcset="images/data-p-500.png 500w, images/data.png 512w" alt="" class="icon"><span class="tooltiptext">Data</span></div> 
              </div>

                <h3 id="w-node-b2117bcb-3f16-0907-2c24-1d7829649a97-ea071f39" class="pagenumber">14 - 23</h3>
              </div>
            </a>
          </li>
          <li class="chapterhandles">
            <a href="#chapter-3" data-w-id="2c45e659-c5ea-685d-478e-c842d32bdac8" class="chapterhandle w-inline-block">
              <div class="w-layout-grid grid-4">
                <h3 class="chaptertitle">Modeling And Evaluation</h3>
                <div>
                    <div class="tooltip"><img src="images/table.png" loading="lazy" alt="" class="icon"><span class="tooltiptext">Table</span></div>
                    <div class="tooltip"><img src="images/graph.png" loading="lazy" alt="" class="icon"><span class="tooltiptext">Graph</span></div>
                    <div class="tooltip"><img src="images/model.png" loading="lazy" alt="" class="icon"><span class="tooltiptext">Model</span></div>
                </div>
                <h3 id="w-node-_2c45e659-c5ea-685d-478e-c842d32bdace-ea071f39" class="pagenumber">24- 49</h3>
              </div>
            </a>
          </li>
        </ol>

        <div class="div-block-4">
          <h6 class="featurehead">Export/Import</h6>
          <div class="exportdiv">
            <div id="w-node-c380f6bc-13b3-0a45-e2b4-a1b25007ffb5-ea071f39" class="featuretext">Save expanded cells as PDF</div>
            <a id="w-node-d325c142-c672-b064-22df-0159d48c0546-ea071f39" href="#" class="featurebutton w-button" value="Print" onclick="javascript:window.print()">Export Code</a>
          </div>
          <h6 class="featurehead">Annotate </h6>
          <div class="exportdiv">
            <div id="w-node-_1cc0ba4d-ed59-af54-9024-39f054e1831c-ea071f39" class="featuretext">Create a note on notebook</div>
           <!--  <a id="w-node-_1cc0ba4d-ed59-af54-9024-39f054e1831e-ea071f39" href="#" class="featurebutton w-button">Add note</a>  -->  
          </div>
        </div>
      </div>

      <!-- The main sections and code stuff -->
      <div id="codecolumn" class="codecolumn w-col w-col-9">
        <div class="div-block"><img src="images/NB_body_topmatter.png" loading="lazy" srcset="images/NB_body_topmatter-p-500.png 500w, images/NB_body_topmatter-p-800.png 800w, images/NB_body_topmatter-p-1080.png 1080w, images/NB_body_topmatter.png 1247w" sizes="(max-width: 767px) 100vw, 75vw" alt="" class="image-4"></div>
        <div id="maincodearea" class="maincodearea">
          <div class="section-2 wf-section">

            <!-- Chapter 1 section contents -->
            <div id="chapter-1" data-w-id="2f630bc3-a25c-6e90-ccd0-b41eccc8e024" style="display:none" class="chapter chapter1">
              <h3 id="Chapter1" class="chapterheading">Chapter 01 - Exploratory Visualization</h3>

              <div data-w-id="40cf1767-71f8-9456-02a5-cfc4774387ae" class="w-layout-grid sectiongrid">
                <a href="#sec1_1" id="w-node-f32cef60-1583-2ca8-e709-d28bc05caa1c-ea071f39" class="sectiontitle">Libraries &amp; System Setup</a>
                <div class="tooltip"><img src="images/library.png" loading="lazy" id="w-node-_40cf1767-71f8-9456-02a5-cfc4774387b2-ea071f39" alt="" class="icon"><span class="tooltiptext">Library</span></div>
              </div>
              <div id="sec1_1" data-w-id="23d0c913-511d-b5c4-c050-d93a2b1153f4" style="display:none" class="sectioncode">
                <!-- <img src="images/chap1-sec1-1.png" loading="lazy" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 3442px) 70vw, 2410px" srcset="images/chap1-sec1-1-p-500.png 500w, images/chap1-sec1-1-p-800.png 800w, images/chap1-sec1-1-p-1080.png 1080w, images/chap1-sec1-1-p-1600.png 1600w, images/chap1-sec1-1-p-2000.png 2000w,
                images/chap1-sec1-1 2410w" alt="" class="codecell"> -->


                <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
                <div class="jp-Cell-inputWrapper">
                <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[49]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                     <div class="CodeMirror cm-s-jupyter">
                       <div class=" highlight hl-ipython3">

                        <span class="kn">import</span> <span class="nn">json</span></br>
                        <span class="kn">import</span> <span class="nn">urllib</span></br>
                        <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span></br>
                        <span class="kn">import</span> <span class="nn">imp</span></br>
                        <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></br>
                        <span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span></br>
                        <span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span></br>
                        <span class="kn">import</span> <span class="nn">math</span></br>

                        <span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">Imputer</span></br>
                        <span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">ensemble</span></br>
                        <span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span></br>
                        <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span></br>
                        <span class="kn">from</span> <span class="nn">sklearn.cross_validation</span> <span class="kn">import</span> <span class="n">cross_val_score</span></br>

                        <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span></br>
                        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span></br>
                        <span class="kn">import</span> <span class="nn">imdb_movie_content</span>
                        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span></br>
                        <span class="o">%</span><span class="k">matplotlib</span> inline</br>
                        <span class="n">imp</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span></br>
                        <span class="n">imp</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">imdb_movie_content</span><span class="p">)</span></br>
                       </div>

                     </div>
                </div>
                </div>
                </div>
                </div>

                <div class="jp-Cell-outputWrapper">
                  <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                  </div>
                  
                  
                  <div class="jp-OutputArea jp-Cell-outputArea">
                  <div class="jp-OutputArea-child jp-OutputArea-executeResult">
                      
                      <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[49]:</div>
                  
                  
                  
                  
                  <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
                  <pre>&lt;module &#39;imdb_movie_content&#39; from &#39;/Users/alexandreattia/Desktop/Work/Practice/HackerRankChallenge/KaggleMovieRating/imdb_movie_content.py&#39;&gt;</pre>
                  </div>
                  
                  </div>
                  
                  </div>
                  
                  </div>

              </div>


              <div data-w-id="4a7e7101-532d-4d82-dd94-e5b4451a9820" class="w-layout-grid sectiongrid">
                <a href="#sec1_1" id="w-node-_4a7e7101-532d-4d82-dd94-e5b4451a9821-ea071f39" class="sectiontitle">Data Loading &amp; Generation</a>
                  <div class="tooltip"><img src="images/data.png" loading="lazy" id="w-node-_36c86509-8fba-0619-4910-a41280cce7b2-ea071f39" sizes="20px" srcset="images/data-p-500.png 500w, images/data.png 512w" alt="" class="icon"><span class="tooltiptext">Data</span></div>
              </div>
              <div data-w-id="c3d14d7e-28ae-c6eb-b783-19806093872e" style="display:none" class="sectioncode">
                <!-- <img src="images/chap1-sec2-1.png" loading="lazy" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 3454px) 70vw, 2418px" srcset="images/chap1-sec2-1-p-500.png 500w, images/chap1-sec2-1-p-800.png 800w, images/chap1-sec2-1-p-1080.png 1080w, images/chap1-sec2-1-p-1600.png 1600w, images/chap1-sec2-1-p-2000.png 2000w,
                images/chap1-sec2-1.png 2418w" alt="" class="codecell"> -->
                <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
                <div class="jp-Cell-inputWrapper">
                <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[35]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                <div class="CodeMirror cm-s-jupyter">
                <div class=" highlight hl-ipython3">
                <span></span><span class="n">df</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">create_dataframe</span><span class="p">(</span><span class="s2">&quot;movie_contents.json&quot;</span><span class="p">,</span> <span class="s2">&quot;movie_budget.json&quot;</span><span class="p">)</span></br>
                <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;movie_title&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></br>
                <span class="n">df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></br>
                <span class="n">awards_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39;nominated&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="ow">or</span> <span class="s1">&#39;won&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">]</span></br>
                <span class="n">df_awards</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">awards_columns</span><span class="p">]</span></br>
                <span class="n">awards_per_movie</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">awards_columns</span><span class="p">)</span> <span class="o">-</span> <span class="n">df_awards</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span></br>
                <span class="n">df</span><span class="p">[</span><span class="s1">&#39;nb_awards&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;movie_title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">awards_per_movie</span><span class="p">)</span></br>
                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">([</span><span class="s1">&#39;movie_title&#39;</span><span class="p">])</span></br>
                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;director_fb_links&#39;</span><span class="p">:</span> <span class="s1">&#39;director_fb_likes&#39;</span><span class="p">})</span></br>
                </div>
                
                      </div>
             </div>
                </div>
                </div>
                </div>

              </div>

              <div data-w-id="2c764ddb-78db-2c80-ee6e-e6983fcb6a36" class="w-layout-grid sectiongrid">
                <a href="#sec1_1" id="w-node-_82343784-77e2-6033-ac1a-49db82d1a0b8-ea071f39" class="sectiontitle">Visual Exploration of Data Space</a>
                  <div class="tooltip"><img src="images/graph.png" loading="lazy" id="w-node-_611e6b02-b075-f70f-fcf9-bdf8ff409259-ea071f39" alt="" class="icon"><span class="tooltiptext">Graph</span></div>
              </div>
              <div data-w-id="26648217-ff37-196f-38cd-44332814d6f1" style="display:none" class="sectioncode">
                <h1 class="chaptersubheading">Awards and Gross</h1>

                <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
                <div class="jp-Cell-inputWrapper">
                <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[3]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                     <div class="CodeMirror cm-s-jupyter">
                    <div class=" highlight hl-ipython3"><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;nb_awards&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="mi">15</span><span class="p">]</span></br>
                      <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span></br>
                      <span class="n">plot</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">d</span><span class="p">)</span></br>
                      <span class="n">_</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">elem</span><span class="p">[:</span><span class="mi">17</span><span class="p">]</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span></br>
                      <span class="n">_</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Most awarded (won and nominated) movies&#39;</span><span class="p">)</span></br>
                      <span class="n">_</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Number of awards&#39;</span><span class="p">)</span></br>
                      </div>
                     </div>
                </div>
                </div>
                </div>
               </div>

                <div class="jp-Cell-outputWrapper">
                <div class="jp-OutputArea jp-Cell-outputArea">
                <div class="jp-OutputArea-child">
                    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[3]:</div>
                </div>

                <div class="jp-OutputArea-child">
                <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                <div class="jp-RenderedImage jp-OutputArea-output ">
                <img src= "images/chap1-sec3-final.png" loading="lazy" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 3454px) 70vw, 2418px"  alt="" class="codecell">
                </div>
                </div>
                </div>
                </div>


                <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
                <div class="jp-Cell-inputWrapper">
                <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[4]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                <div class="CodeMirror cm-s-jupyter">
                <div class=" highlight hl-ipython3">
                  <span></span><span class="n">d</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">worldwide_gross</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="mi">17</span><span class="p">]</span></br>
                  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span></br>
                  <span class="n">plot</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">d</span><span class="p">)</span></br>
                  <span class="n">_</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">elem</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span></br>
                  <span class="n">_</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Most prolific movies&#39;</span><span class="p">)</span></br>
                  <span class="n">_</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Gross (B$)&#39;</span><span class="p">)</span></br>
                  </pre></div>
                </div>
                </div>
                </div>
                </div>
                </div>

                <div class="jp-Cell-outputWrapper">
                  <div class="jp-OutputArea jp-Cell-outputArea">
                  <div class="jp-OutputArea-child">
                      <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[4]:</div>
                  </div>
  
                  <div class="jp-OutputArea-child">
                  <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                  <div class="jp-RenderedImage jp-OutputArea-output ">
                  <img src= "images/chap1-sec3_1-final.png" loading="lazy" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 3454px) 70vw, 2418px"  alt="" class="codecell">
                  </div>
                  </div>
                  </div>
                  </div>
              </div>



              <div data-w-id="f40a25b1-ad02-baf0-b94c-4cf40bd0924e" class="w-layout-grid sectiongrid">
                <a href="#" class="sectiontitle w-button">Inspection based transformation</a>
                <div class="tooltip"><img src="images/graph.png" loading="lazy" id="w-node-_611e6b02-b075-f70f-fcf9-bdf8ff409259-ea071f39" alt="" class="icon"><span class="tooltiptext">Graph</span></div>
              </div>
              <div data-w-id="f0e625ce-3c23-6b19-9b86-271b3451ab40" style="display:none" class="sectioncode">


                <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
                  <div class="jp-Cell-inputWrapper">
                  <div class="jp-InputArea jp-Cell-inputArea">
                  <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[885]:</div>
                  <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                  <div class="CodeMirror cm-s-jupyter">
                  <div class=" highlight hl-ipython3">
                    <span></span><span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span></br>

                    <span class="n">d</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">worldwide_gross</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="mi">20</span><span class="p">]</span></br>
                    <span class="n">e</span> <span class="o">=</span> <span class="n">df_awards</span><span class="p">[</span><span class="n">df_awards</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></br>
                    <span class="n">e</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">awards_columns</span><span class="p">)</span> <span class="o">-</span> <span class="n">e</span><span class="p">[</span><span class="o">~</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">)</span></br>
                    
                    <span class="n">margin</span> <span class="o">=</span> <span class="mf">0.05</span></br>
                    <span class="n">width</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="n">margin</span><span class="p">)</span><span class="o">/</span><span class="mi">15</span></br>
                    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span></br>
                    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span></br>
                    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span></br>
                    <span class="n">d</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></br>
                    <span class="n">e</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></br>
                    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Worldwide Gross (GREEN)&#39;</span><span class="p">)</span></br>
                    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Awards (BLUE)&#39;</span><span class="p">)</span></br>
                    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span></br>
                    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Comparaison between Worldwide Gross and Awards&#39;</span><span class="p">)</span></br>
                    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">elem</span><span class="p">[:</span><span class="mi">17</span><span class="p">]</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">rotation</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span></br>
                    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></br>
                    </div>
                  </div>
                  </div>
                  </div>
                  </div>
                  </div>
  
                  <div class="jp-Cell-outputWrapper">
                    <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[885]:</div>
                    </div>
    
                    <div class="jp-OutputArea-child">
                    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                    <div class="jp-RenderedImage jp-OutputArea-output ">
                    <img src= "images/chap1-sec3_2-final.png" loading="lazy" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 3454px) 70vw, 2418px"  alt="" class="codecell">
                </div>
                
                </div>
                </div>
                </div>
                <h1 class="chaptersubheading">Facebook likes</h1>
                <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
                  <div class="jp-Cell-inputWrapper">
                  <div class="jp-InputArea jp-Cell-inputArea">
                  <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[888]:</div>
                  <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                  <div class="CodeMirror cm-s-jupyter">
                  <div class=" highlight hl-ipython3">
                    <span></span><span class="n">d</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;total_cast_fb_likes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="mi">15</span><span class="p">]</span></br>
                    <span class="n">e</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span><span class="o">.</span><span class="n">num_facebook_like</span></br>
                    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span></br>
                    <span class="n">plot</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">d</span><span class="p">)</span></br>
                    <span class="n">_</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">elem</span><span class="p">[:</span><span class="mi">17</span><span class="p">]</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span></br>
                    <span class="n">_</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Movies with the most &quot;famous&quot; casting&#39;</span><span class="p">)</span></br>
                    <span class="n">_</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Total Facebook Likes (casting + director)&#39;</span><span class="p">)</span></br>
                    </div>
                  </div>
                  </div>
                  </div>
                  </div>
                  </div>
  
                  <div class="jp-Cell-outputWrapper">
                    <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[888]:</div>
                    </div>
    
                    <div class="jp-OutputArea-child">
                    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                    <div class="jp-RenderedImage jp-OutputArea-output ">
                    <img src= "images/chap1-sec3_3-final.png" loading="lazy" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 3454px) 70vw, 2418px"  alt="" class="codecell">
                    </div>
                    </div>
                    </div>
                    </div>



                    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
                      <div class="jp-Cell-inputWrapper">
                      <div class="jp-InputArea jp-Cell-inputArea">
                      <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[548]:</div>
                      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                      <div class="CodeMirror cm-s-jupyter">
                      <div class=" highlight hl-ipython3">
                        <span></span><span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span></br>
    
                        <span class="n">d</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;total_cast_fb_likes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="mi">20</span><span class="p">]</span></br>
                        <span class="n">e</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span><span class="o">.</span><span class="n">num_facebook_like</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">)</span></br>
                        <span class="n">margin</span> <span class="o">=</span> <span class="mf">0.05</span></br>
                        <span class="n">width</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="n">margin</span><span class="p">)</span><span class="o">/</span><span class="mi">15</span></br>
                        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span></br>
                        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span></br>
                        <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span></br>
                        <span class="n">d</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></br>
                        <span class="n">e</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></br>
                        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Casting Likes (GREEN)&#39;</span><span class="p">)</span></br>
                        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Movie Likes (BLUE)&#39;</span><span class="p">)</span></br>
                        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span></br>
                        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Comparaison between Casting Likes and Movie Likes&#39;</span><span class="p">)</span></br>
                        <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">elem</span><span class="p">[:</span><span class="mi">17</span><span class="p">]</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">rotation</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span></br>
                        <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></br>
                        </div>
                        
                      </div>
                      </div>
                      </div>
                      </div>
                      </div>
      
                      <div class="jp-Cell-outputWrapper">
                        <div class="jp-OutputArea jp-Cell-outputArea">
                        <div class="jp-OutputArea-child">
                            <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[548]:</div>
                        </div>
        
                        <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                        <div class="jp-RenderedImage jp-OutputArea-output ">
                        <img src= "images/chap1-sec3_4-final.png" loading="lazy" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 3454px) 70vw, 2418px"  alt="" class="codecell">
                        </div>
                        </div>
                        </div>
                        </div>   



            </div>
          </div>
        </div>
      </div>



            <!-- Chapter 2 section contents -->
            <div id="chapter-2" data-w-id="4eacca90-4dd7-e300-3701-ba598547b738" style="display:none" class="chapter chapter2">
              <h1 class="chapterheading">Chapter 02 - Data Cleaning</h1>

              <h1 class="chaptersubheading">Best Actors</h1>
              <div data-w-id="b4f485ea-a6b5-a151-7e12-9c482aa5785e" class="w-layout-grid sectiongrid">
                <a href="#" class="sectiontitle w-button">Domain Specific Wrangling</a>
              </div>
              <div data-w-id="307e2377-ea39-69e9-a5b3-7522b862ad5b" style="display:none" class="sectioncode">

                <h2 class="chaptersubheading">Actor in movie</h2>
                <!-- <img src="images/chap2-sec1-1.png" loading="lazy" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 3457px) 70vw, 2420px" srcset="images/chap2-sec1-1-p-500.png 500w, images/chap2-sec1-1-p-800.png 800w, images/chap2-sec1-1-p-1080.png 1080w, images/chap2-sec1-1-p-1600.png 1600w, images/chap2-sec1-1-p-2000.png 2000w,
                images/chap2-sec1-1.png 2420w" alt=""> -->

                <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
                <div class="jp-Cell-inputWrapper">
                <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[5]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                     <div class="CodeMirror cm-s-jupyter">
                <div class=" highlight hl-ipython3">
                  <span></span><span class="n">all_actors</span> <span class="o">=</span> <span class="p">[</span><span class="n">actor</span> <span class="k">for</span> <span class="n">actor</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">actor_1_name</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">actor_2_name</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">actor_3_name</span><span class="p">)))</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notnull</span><span class="p">(</span><span class="n">actor</span><span class="p">)]</span></br>
                  <span class="n">imdb_score_per_actor</span> <span class="o">=</span> <span class="p">{}</span></br>
                  <span class="k">for</span> <span class="n">actor</span> <span class="ow">in</span> <span class="n">all_actors</span><span class="p">:</span></br>
                  &nbsp &nbsp   <span class="n">imdb_score_per_actor</span><span class="p">[</span><span class="n">actor</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">actor_1_name</span> <span class="o">==</span> <span class="n">actor</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">actor_2_name</span> <span class="o">==</span> <span class="n">actor</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n"> </br>
                  &nbsp &nbsp
      <span class="n">actor_3_name</span> <span class="o">==</span> <span class="n">actor</span><span class="p">)]</span><span class="o">.</span><span class="n">idmb_score</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span></br>
                  </div>
                     </div>
                </div>
                </div>
                </div>

                <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
                  <div class="jp-Cell-inputWrapper">
                    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                    </div>
                    <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[6]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                         <div class="CodeMirror cm-s-jupyter">
                    <div class=" highlight hl-ipython3">
                      <pre><span></span><span class="n">millnames</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39; K&#39;</span><span class="p">,</span><span class="s1">&#39; M&#39;</span><span class="p">,</span><span class="s1">&#39; B&#39;</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">millify</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notnull</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
       <span class="n">n</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
       <span class="n">millidx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">millnames</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                                <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mi">0</span> <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">/</span><span class="mi">3</span><span class="p">))))</span>
       <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{:.1f}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">millidx</span><span class="p">),</span> <span class="n">millnames</span><span class="p">[</span><span class="n">millidx</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
       <span class="k">return</span> <span class="n">n</span>
                    </pre></div>
                    
                         </div>
                       </div>
                  </div>
                  </div>
                  </div>




                  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
                    <div class="jp-Cell-inputWrapper">
                      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                      </div>
                      <div class="jp-InputArea jp-Cell-inputArea">
                      <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[7]:</div>
                      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                           <div class="CodeMirror cm-s-jupyter">
                      <div class=" highlight hl-ipython3"><pre><span></span>
<span class="n">gross_per_actor</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">actor</span> <span class="ow">in</span> <span class="n">all_actors</span><span class="p">:</span>
    <span class="n">gross_per_actor</span><span class="p">[</span><span class="n">actor</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">actor_1_name</span> <span class="o">==</span> <span class="n">actor</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">actor_2_name</span> <span class="o">==</span> <span class="n">actor</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">actor_3_name</span> <span class="o">==</span> <span class="n">actor</span><span class="p">)]</span><span class="o">.</span><span class="n">worldwide_gross</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                      </pre></div>
                      
                           </div>
                         </div>
                    </div>
                    </div>
                    </div>


                    <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
                      <div class="jp-Cell-inputWrapper">
                        <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                        </div>
                        <div class="jp-InputArea jp-Cell-inputArea">
                        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[9]:</div>
                        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                             <div class="CodeMirror cm-s-jupyter">
                        <div class=" highlight hl-ipython3"><pre><span></span>
<span class="n">mini_movie</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">top_k</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">best_mini_gross</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">gross_per_actor</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">actor_1_name</span> <span class="o">==</span> <span class="n">k</span><span class="p">)</span> 
                                                                                                                                   <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">actor_2_name</span> <span class="o">==</span> <span class="n">k</span><span class="p">)</span> 
                                                                                                                                   <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">actor_3_name</span> <span class="o">==</span> <span class="n">k</span><span class="p">)])</span> <span class="o">&gt;=</span> <span class="n">mini_movie</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="mi">20</span><span class="p">]</span>
                        
<span class="n">best_mini_gross_str</span> <span class="o">=</span> <span class="p">[</span><span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span> <span class="s1">&#39;, </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%s</span><span class="s1"> movie.s)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">millify</span><span class="p">(</span><span class="n">elem</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">actor_1_name</span> <span class="o">==</span> <span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> 
                                                                           <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">actor_2_name</span> <span class="o">==</span> <span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> 
                                                                           <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">actor_3_name</span> <span class="o">==</span> <span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">])]))</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">best_mini_gross</span><span class="p">][:</span><span class="n">top_k</span><span class="p">]</span>
                        
<span class="n">best_mini</span> <span class="o">=</span> <span class="p">[(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">imdb_score_per_actor</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">actor_1_name</span> <span class="o">==</span> <span class="n">k</span><span class="p">)</span> 
                                                                                                                           <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">actor_2_name</span> <span class="o">==</span> <span class="n">k</span><span class="p">)</span> 
                                                                                                                           <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">actor_3_name</span> <span class="o">==</span> <span class="n">k</span><span class="p">)])</span> <span class="o">&gt;=</span> <span class="n">mini_movie</span><span class="p">][:</span><span class="mi">20</span><span class="p">]</span>
                        
<span class="n">best_mini_str</span> <span class="o">=</span> <span class="p">[</span><span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span> <span class="s1">&#39;, </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%s</span><span class="s1"> movie.s)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">elem</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">actor_1_name</span> <span class="o">==</span> <span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> 
                                                                           <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">actor_2_name</span> <span class="o">==</span> <span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> 
                                                                           <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">actor_3_name</span> <span class="o">==</span> <span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">])]))</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">best_mini</span><span class="p">][:</span><span class="n">top_k</span><span class="p">]</span>
                        </pre></div>
                        
                             </div>
                           </div>
                      </div>
                      </div>
                      </div>


                </div>


                
                

                <!--
                <img src="images/chap2-sec1-2.png" loading="lazy" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 2800px) 69vw, 1932px" srcset="images/chap2-sec1-2-p-500.png 500w, images/chap2-sec1-2-p-800.png 800w, images/chap2-sec1-2-p-1080.png 1080w, images/chap2-sec1-2-p-1600.png 1600w, images/chap2-sec1-2.png 1932w" alt="">
                <img src="images/chap2-sec1-3.png" loading="lazy" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 2797px) 69vw, 1930px" srcset="images/chap2-sec1-3-p-500.png 500w, images/chap2-sec1-3-p-800.png 800w, images/chap2-sec1-3-p-1080.png 1080w, images/chap2-sec1-3-p-1600.png 1600w, images/chap2-sec1-3.png 1930w" alt="">
                <img src="images/chap2-sec1-4.png" loading="lazy" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 2800px) 69vw, 1932px" srcset="images/chap2-sec1-4-p-500.png 500w, images/chap2-sec1-4-p-800.png 800w, images/chap2-sec1-4-p-1080.png 1080w, images/chap2-sec1-4-p-1600.png 1600w, images/chap2-sec1-4.png 1932w" alt=""> -->
              </div>

              <div data-w-id="16fd7829-53a3-0298-2205-faf67af86e86" class="w-layout-grid sectiongrid">
                <a href="#" class="sectiontitle w-button">Data Transformation Verification</a>
              </div>
              <div data-w-id="14fb2eb2-884f-f27e-06db-fd60511fb71c" style="display:none" class="sectioncode">



                <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
                  <div class="jp-Cell-inputWrapper">
                    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                    </div>
                    <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[10]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                         <div class="CodeMirror cm-s-jupyter">
                    <div class=" highlight hl-ipython3"><pre><span></span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The </span><span class="si">{}</span><span class="s1"> best actors are (with minimum </span><span class="si">{}</span><span class="s1"> movies) : </span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">top_k</span><span class="p">,</span> <span class="n">mini_movie</span><span class="p">,</span>
                           <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">best_mini_str</span><span class="p">)))</span>
                    
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">The </span><span class="si">{}</span><span class="s1"> most prolific actors are (with minimum </span><span class="si">{}</span><span class="s1"> movies) : </span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">top_k</span><span class="p">,</span> <span class="n">mini_movie</span><span class="p">,</span>
                           <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">best_mini_gross_str</span><span class="p">)))</span>
                    </pre></div>
                    
                         </div>
                    </div>
                    </div>
                    </div>
                    
                    <div class="jp-Cell-outputWrapper">
                    <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                    </div>
                    
                    
                    <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        
                        <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                    
                    
                    <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
                    <pre>
The 3 best actors are (with minimum 3 movies) : 
Mark Hamill, 8.63 (3 movie.s)
Michael Biehn, 8.0 (3 movie.s)
Cate Blanchett, 7.82 (8 movie.s)

The 3 most prolific actors are (with minimum 3 movies) : 
Richard Armitage, 825.8 M (4 movie.s)
Rupert Grint, 701.6 M (5 movie.s)
Orlando Bloom, 682.8 M (7 movie.s)}}}
                    </pre>
                    </div>
                    </div>
                    
                    </div>
                  </div>
                    </div>

                <!-- <img src="images/chap2-sec2-1.png" loading="lazy" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 2800px) 69vw, 1932px" srcset="images/chap2-sec2-1-p-500.png 500w, images/chap2-sec2-1-p-800.png 800w, images/chap2-sec2-1-p-1080.png 1080w, images/chap2-sec2-1-p-1600.png 1600w, images/chap2-sec2-1.png 1932w" alt=""> -->
              </div>

              <div data-w-id="3c2e5d58-abc6-b169-6d22-4258b0304083" class="w-layout-grid sectiongrid">
                <a href="#" class="sectiontitle w-button">Output verification</a>
                <div class="tooltip"><img src="images/table.png" loading="lazy" id="w-node-_474e4a82-628a-a6fa-4213-2ce1923b9a16-ea071f39" alt="" class="icon"><span class="tooltiptext">Table</span></div>

              </div>
              <div data-w-id="23b14031-4d97-55d8-357d-183551f30ef2" style="display:none" class="sectioncode">
                <!-- <img src="images/chap2-sec3-1.png" loading="lazy" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 2800px) 69vw, 1932px" srcset="images/chap2-sec3-1-p-500.png 500w, images/chap2-sec3-1-p-800.png 800w, images/chap2-sec3-1-p-1080.png 1080w, images/chap2-sec3-1-p-1600.png 1600w, images/chap2-sec3-1.png 1932w" alt=""> -->
                <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
                  <div class="jp-Cell-inputWrapper">
                    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                    </div>
                    <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[11]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                         <div class="CodeMirror cm-s-jupyter">
                    <div class=" highlight hl-ipython3"><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span></br>
                    
                    <span class="n">plot</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">([</span><span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">best_mini</span><span class="p">],</span> <span class="p">[</span><span class="n">elem</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">best_mini</span><span class="p">])</span></br>
                    <span class="n">_</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">best_mini</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span></br>
                    <span class="n">_</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Most beneficial (IMDB score) actors&#39;</span><span class="p">)</span></br>
                    <span class="n">_</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;IMDB score&#39;</span><span class="p">)</span></br>
                    </div>
                     </div>
                </div>
                </div>
                </div>

                <div class="jp-Cell-outputWrapper">
                  <div class="jp-OutputArea jp-Cell-outputArea">
                  <div class="jp-OutputArea-child">
                      <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[11]:</div>
                  </div>
  
                  <div class="jp-OutputArea-child">
                  <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                  <div class="jp-RenderedImage jp-OutputArea-output ">
                  <img src= "images/chap2-sec3_1-final.png" loading="lazy" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 3454px) 70vw, 2418px"  alt="" class="codecell">
                  </div>
                  </div>
                  </div>
                  </div>   



                  <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
                    <div class="jp-Cell-inputWrapper">
                      <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                      </div>
                      <div class="jp-InputArea jp-Cell-inputArea">
                      <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[12]:</div>
                      <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                           <div class="CodeMirror cm-s-jupyter">
                      <div class=" highlight hl-ipython3"><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span></br>
                      <span class="n">plot</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">([</span><span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">best_mini_gross</span><span class="p">],</span> <span class="p">[</span><span class="n">elem</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">best_mini_gross</span><span class="p">])</span></br>
                      <span class="n">_</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">best_mini_gross</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span></br>
                      <span class="n">_</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Most prolific actors&#39;</span><span class="p">)</span></br>
                      <span class="n">_</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Worldwide gross&#39;</span><span class="p">)</span></br>
                      </div>
                       </div>
                  </div>
                  </div>
                  </div>

                </div>
              </div>

                  <div class="jp-Cell-outputWrapper">
                    <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[548]:</div>
                    </div>
    
                    <div class="jp-OutputArea-child">
                    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                    <div class="jp-RenderedImage jp-OutputArea-output ">
                    <img src= "images/chap2-sec3_2-final.png" loading="lazy" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 3454px) 70vw, 2418px"  alt="" class="codecell">
                    </div>
                    </div>
                    </div>
                    </div>                   
              </div>


                    <div data-w-id="3c3e5d58-abc6-b169-6d22-4258b0304083" class="w-layout-grid sectiongrid">
                      <a href="#" class="sectiontitle w-button">Transformation and Visual Inspection</a>
                      <div class="tooltip"><img src="images/table.png" loading="lazy" id="w-node-_474e4a82-628a-a6fa-4213-2ce1923b9a16-ea071f39" alt="" class="icon"><span class="tooltiptext">Table</span>
                      <img src="images/graph.png" loading="lazy" id="w-node-_474e4a82-628a-a6fa-4213-2ce1923b9a16-ea071f39" alt="" class="icon"><span class="tooltiptext">Table</span></div>

                    </div>
                    <div data-w-id="25b14031-4d97-55d8-357d-183551f30ef2" style="display:none" class="sectioncode">
                      <h2 class="chaptersubheading">First star in movie</h2>

                      <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
                        <div class="jp-Cell-inputWrapper">
                          <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                          </div>
                          <div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
                          </div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
                          </div>
                          </div>
                          </div>
                          </div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
                          <div class="jp-Cell-inputWrapper">
                          <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                          </div>
                          <div class="jp-InputArea jp-Cell-inputArea">
                          <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[553]:</div>
                          <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                               <div class="CodeMirror cm-s-jupyter">
                          <div class=" highlight hl-ipython3"><pre><span></span><span class="n">big_star</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;actor_1_name&#39;</span><span class="p">])[</span><span class="s1">&#39;idmb_score&#39;</span><span class="p">,</span> <span class="s1">&#39;worldwide_gross&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;idmb_score&#39;</span><span class="p">,</span> <span class="s1">&#39;worldwide_gross&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">big_star</span><span class="p">[</span><span class="s1">&#39;nb_movies&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">big_star</span><span class="o">.</span><span class="n">index</span>
<span class="n">big_star</span><span class="p">[</span><span class="s1">&#39;nb_movies&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">big_star</span><span class="p">[</span><span class="s1">&#39;nb_movies&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;actor_1_name&#39;</span><span class="p">])[</span><span class="s1">&#39;movie_title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
<span class="n">big_star</span><span class="p">[</span><span class="s1">&#39;worldwide_gross&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">big_star</span><span class="p">[</span><span class="s1">&#39;worldwide_gross&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">millify</span><span class="p">)</span>
<span class="n">top_k</span> <span class="o">=</span> <span class="mi">7</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The </span><span class="si">{}</span><span class="s1"> best actors as most famous actor are :&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">top_k</span><span class="p">))</span>
<span class="n">big_star</span><span class="p">[</span><span class="n">big_star</span><span class="o">.</span><span class="n">nb_movies</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">top_k</span><span class="p">)</span>
</pre></div>
                          
                      </div>
                      </div>
                      </div>






                </div>

                <div class="jp-Cell-outputWrapper">
                  <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                  </div>
                  
                  
                  <div class="jp-OutputArea jp-Cell-outputArea">
                  <div class="jp-OutputArea-child">
                      
                      <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                  
                  
                  <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
                  <pre>The 7 best actors as most famous actor are :
                  </pre>
                  </div>
                  </div>
                  <div class="jp-OutputArea-child jp-OutputArea-executeResult">
                      
                      <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[553]:</div>
                  
                  
                  
                  <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html">
                  <div>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right;">
                        <th></th>
                        <th>idmb_score</th>
                        <th>worldwide_gross</th>
                        <th>nb_movies</th>
                      </tr>
                      <tr>
                        <th>actor_1_name</th>
                        <th></th>
                        <th></th>
                        <th></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>Leonardo DiCaprio</th>
                        <td>8.122222</td>
                        <td>398.5 M</td>
                        <td>9</td>
                      </tr>
                      <tr>
                        <th>Matthew McConaughey</th>
                        <td>7.800000</td>
                        <td>255.5 M</td>
                        <td>3</td>
                      </tr>
                      <tr>
                        <th>Tom Hanks</th>
                        <td>7.787500</td>
                        <td>411.4 M</td>
                        <td>8</td>
                      </tr>
                      <tr>
                        <th>Richard Armitage</th>
                        <td>7.733333</td>
                        <td>977.5 M</td>
                        <td>3</td>
                      </tr>
                      <tr>
                        <th>Christopher Lee</th>
                        <td>7.475000</td>
                        <td>557.7 M</td>
                        <td>4</td>
                      </tr>
                      <tr>
                        <th>Daniel Craig</th>
                        <td>7.400000</td>
                        <td>422.9 M</td>
                        <td>4</td>
                      </tr>
                      <tr>
                        <th>Tom Hardy</th>
                        <td>7.350000</td>
                        <td>403.9 M</td>
                        <td>4</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                </div>
                
                </div>
                
                </div>
                
                </div>

                </div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
                  <div class="jp-Cell-inputWrapper">
                  <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                  </div>
                  <div class="jp-InputArea jp-Cell-inputArea">
                  <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[521]:</div>
                  <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                       <div class="CodeMirror cm-s-jupyter">
                  <div class=" highlight hl-ipython3"><pre><span></span><span class="n">big_star</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;actor_1_name&#39;</span><span class="p">])[</span><span class="s1">&#39;idmb_score&#39;</span><span class="p">,</span> <span class="s1">&#39;worldwide_gross&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;worldwide_gross&#39;</span><span class="p">,</span> <span class="s1">&#39;idmb_score&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">big_star</span><span class="p">[</span><span class="s1">&#39;nb_movies&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">big_star</span><span class="o">.</span><span class="n">index</span>
<span class="n">big_star</span><span class="p">[</span><span class="s1">&#39;nb_movies&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">big_star</span><span class="p">[</span><span class="s1">&#39;nb_movies&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;actor_1_name&#39;</span><span class="p">])[</span><span class="s1">&#39;movie_title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
<span class="n">big_star</span><span class="p">[</span><span class="s1">&#39;worldwide_gross&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">big_star</span><span class="p">[</span><span class="s1">&#39;worldwide_gross&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">millify</span><span class="p">)</span>
<span class="n">top_k</span> <span class="o">=</span> <span class="mi">7</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The </span><span class="si">{}</span><span class="s1"> most prolific actors as most famous actor are :&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">top_k</span><span class="p">))</span>
<span class="n">big_star</span><span class="p">[</span><span class="n">big_star</span><span class="o">.</span><span class="n">nb_movies</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">top_k</span><span class="p">)</span>
</pre></div>
                  
                       </div>
                  </div>
                  </div>
                  </div>
                  
                  <div class="jp-Cell-outputWrapper">
                  <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                  </div>
                  
                  
                  <div class="jp-OutputArea jp-Cell-outputArea">
                  <div class="jp-OutputArea-child">
                      
                      <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                  
                  
                  <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
                  <pre>The 7 most prolific actors as most famous actor are :
                  </pre>
                  </div>
                  </div>
                  <div class="jp-OutputArea-child jp-OutputArea-executeResult">
                      
                      <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[521]:</div>
                  
                  
                  
                  <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html">
                  <div>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right;">
                        <th></th>
                        <th>idmb_score</th>
                        <th>worldwide_gross</th>
                        <th>nb_movies</th>
                      </tr>
                      <tr>
                        <th>actor_1_name</th>
                        <th></th>
                        <th></th>
                        <th></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>Richard Armitage</th>
                        <td>7.733333</td>
                        <td>977.5 M</td>
                        <td>3</td>
                      </tr>
                      <tr>
                        <th>Robert Pattinson</th>
                        <td>5.675000</td>
                        <td>763.5 M</td>
                        <td>4</td>
                      </tr>
                      <tr>
                        <th>Chris Hemsworth</th>
                        <td>7.083333</td>
                        <td>751.6 M</td>
                        <td>6</td>
                      </tr>
                      <tr>
                        <th>Jennifer Lawrence</th>
                        <td>7.200000</td>
                        <td>621.7 M</td>
                        <td>8</td>
                      </tr>
                      <tr>
                        <th>J.K. Simmons</th>
                        <td>6.925000</td>
                        <td>605.8 M</td>
                        <td>8</td>
                      </tr>
                      <tr>
                        <th>Angelina Jolie</th>
                        <td>7.075000</td>
                        <td>586.5 M</td>
                        <td>4</td>
                      </tr>
                      <tr>
                        <th>Henry Cavill</th>
                        <td>6.600000</td>
                        <td>582.6 M</td>
                        <td>3</td>
                      </tr>
                    </tbody>
                  </table>
                  </div>
                  </div>
                  
                  </div>
                  
                  </div>
                  
                  </div>
                  
                  </div>

                  <h2 class="chaptersubheading">IMDB rating and other variables</h2>

                  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
                    <div class="jp-Cell-inputWrapper">
                    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                    </div>
                    <div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
                    </div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
                    </div>
                    </div>
                    </div>
                    </div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
                    <div class="jp-Cell-inputWrapper">
                    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                    </div>
                    <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[249]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                         <div class="CodeMirror cm-s-jupyter">
                    <div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;idmb_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="mi">12</span><span class="p">]</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span><span class="o">.</span><span class="n">num_facebook_like</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span><span class="o">.</span><span class="n">worldwide_gross</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">margin</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">width</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="n">margin</span><span class="p">)</span><span class="o">/</span><span class="mi">15</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax3</span><span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">d</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">e</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;IMDB Score (GREEN)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Movie Likes(BLUE) and Gross(PURPLE)&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">elem</span><span class="p">[:</span><span class="mi">17</span><span class="p">]</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">rotation</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gross and Movie Likes compared to IMDB score&#39;</span><span class="p">)</span>
                    </pre></div>
                    
                         </div>
                    </div>
                    </div>
                    </div>
                    
                    <div class="jp-Cell-outputWrapper">
                    <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                    </div>
                    
                    
                    <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child jp-OutputArea-executeResult">
                        
                        <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[249]:</div>
                    
                        <div class="jp-Cell-outputWrapper">
                          <div class="jp-OutputArea jp-Cell-outputArea">
                          <div class="jp-OutputArea-child">
                              <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[548]:</div>
                          </div>
          
                          <div class="jp-OutputArea-child">
                          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                          <div class="jp-RenderedImage jp-OutputArea-output ">
                          <img src= "images/chap2-sec3_4-final.png" loading="lazy" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 3454px) 70vw, 2418px"  alt="" class="codecell">
                          </div>
                          </div>
                          </div>
                          </div>                   
                    </div>        
              </div>

            </div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
              <div class="jp-Cell-inputWrapper">
              <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
              </div>
              <div class="jp-InputArea jp-Cell-inputArea">
              <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[14]:</div>
              <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                   <div class="CodeMirror cm-s-jupyter">
              <div class=" highlight hl-ipython3"><pre><span></span>
<span class="c1"># Correlation Matrix</span>
              
<span class="n">corr</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;nb_awards&#39;</span><span class="p">,</span> <span class="s1">&#39;domestic_gross&#39;</span><span class="p">,</span><span class="s1">&#39;worldwide_gross&#39;</span><span class="p">,</span> 
                  <span class="s1">&#39;total_cast_fb_likes&#39;</span><span class="p">,</span><span class="s1">&#39;director_fb_likes&#39;</span><span class="p">,</span> <span class="s1">&#39;production_budget&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;num_critic_for_reviews&#39;</span><span class="p">,</span> <span class="s1">&#39;idmb_score&#39;</span><span class="p">,</span> <span class="s1">&#39;actor_1_fb_likes&#39;</span><span class="p">,</span> <span class="s1">&#39;actor_2_fb_likes&#39;</span><span class="p">,</span> <span class="s1">&#39;actor_3_fb_likes&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">diverging_palette</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">as_cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                  <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Correlation matrix for 7 variables and the IMDB Score&#39;</span><span class="p">)</span>
<span class="n">corr</span>
              </pre></div>
              
                   </div>
              </div>
              </div>
              </div>
            </div>



            <div class="jp-Cell-outputWrapper">
              <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
              </div>
              
              
              <div class="jp-OutputArea jp-Cell-outputArea">
              <div class="jp-OutputArea-child jp-OutputArea-executeResult">
                  
                  <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[14]:</div>
              
              
              
              <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html">
              <div>
              <table border="1" class="dataframe">
                <thead>
                  <tr style="text-align: right;">
                    <th></th>
                    <th>nb_awards</th>
                    <th>domestic_gross</th>
                    <th>worldwide_gross</th>
                    <th>total_cast_fb_likes</th>
                    <th>director_fb_likes</th>
                    <th>production_budget</th>
                    <th>num_critic_for_reviews</th>
                    <th>idmb_score</th>
                    <th>actor_1_fb_likes</th>
                    <th>actor_2_fb_likes</th>
                    <th>actor_3_fb_likes</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th>nb_awards</th>
                    <td>1.000000</td>
                    <td>0.256910</td>
                    <td>0.232643</td>
                    <td>0.129949</td>
                    <td>0.256985</td>
                    <td>0.046063</td>
                    <td>0.261310</td>
                    <td>0.413660</td>
                    <td>0.041738</td>
                    <td>0.161491</td>
                    <td>0.147963</td>
                  </tr>
                  <tr>
                    <th>domestic_gross</th>
                    <td>0.256910</td>
                    <td>1.000000</td>
                    <td>0.935842</td>
                    <td>0.277702</td>
                    <td>0.176098</td>
                    <td>0.649957</td>
                    <td>0.483601</td>
                    <td>0.263081</td>
                    <td>0.079222</td>
                    <td>0.324051</td>
                    <td>0.368906</td>
                  </tr>
                  <tr>
                    <th>worldwide_gross</th>
                    <td>0.232643</td>
                    <td>0.935842</td>
                    <td>1.000000</td>
                    <td>0.277677</td>
                    <td>0.164262</td>
                    <td>0.724943</td>
                    <td>0.517116</td>
                    <td>0.245807</td>
                    <td>0.066839</td>
                    <td>0.339250</td>
                    <td>0.396354</td>
                  </tr>
                  <tr>
                    <th>total_cast_fb_likes</th>
                    <td>0.129949</td>
                    <td>0.277702</td>
                    <td>0.277677</td>
                    <td>1.000000</td>
                    <td>0.280496</td>
                    <td>0.305823</td>
                    <td>0.360474</td>
                    <td>0.218539</td>
                    <td>0.873110</td>
                    <td>0.632069</td>
                    <td>0.641536</td>
                  </tr>
                  <tr>
                    <th>director_fb_likes</th>
                    <td>0.256985</td>
                    <td>0.176098</td>
                    <td>0.164262</td>
                    <td>0.280496</td>
                    <td>1.000000</td>
                    <td>0.128954</td>
                    <td>0.243488</td>
                    <td>0.264821</td>
                    <td>0.069803</td>
                    <td>0.204641</td>
                    <td>0.249485</td>
                  </tr>
                  <tr>
                    <th>production_budget</th>
                    <td>0.046063</td>
                    <td>0.649957</td>
                    <td>0.724943</td>
                    <td>0.305823</td>
                    <td>0.128954</td>
                    <td>1.000000</td>
                    <td>0.489272</td>
                    <td>0.087965</td>
                    <td>0.096173</td>
                    <td>0.367139</td>
                    <td>0.419698</td>
                  </tr>
                  <tr>
                    <th>num_critic_for_reviews</th>
                    <td>0.261310</td>
                    <td>0.483601</td>
                    <td>0.517116</td>
                    <td>0.360474</td>
                    <td>0.243488</td>
                    <td>0.489272</td>
                    <td>1.000000</td>
                    <td>0.346106</td>
                    <td>0.126010</td>
                    <td>0.451665</td>
                    <td>0.469634</td>
                  </tr>
                  <tr>
                    <th>idmb_score</th>
                    <td>0.413660</td>
                    <td>0.263081</td>
                    <td>0.245807</td>
                    <td>0.218539</td>
                    <td>0.264821</td>
                    <td>0.087965</td>
                    <td>0.346106</td>
                    <td>1.000000</td>
                    <td>0.101598</td>
                    <td>0.230435</td>
                    <td>0.232669</td>
                  </tr>
                  <tr>
                    <th>actor_1_fb_likes</th>
                    <td>0.041738</td>
                    <td>0.079222</td>
                    <td>0.066839</td>
                    <td>0.873110</td>
                    <td>0.069803</td>
                    <td>0.096173</td>
                    <td>0.126010</td>
                    <td>0.101598</td>
                    <td>1.000000</td>
                    <td>0.284472</td>
                    <td>0.250632</td>
                  </tr>
                  <tr>
                    <th>actor_2_fb_likes</th>
                    <td>0.161491</td>
                    <td>0.324051</td>
                    <td>0.339250</td>
                    <td>0.632069</td>
                    <td>0.204641</td>
                    <td>0.367139</td>
                    <td>0.451665</td>
                    <td>0.230435</td>
                    <td>0.284472</td>
                    <td>1.000000</td>
                    <td>0.815911</td>
                  </tr>
                  <tr>
                    <th>actor_3_fb_likes</th>
                    <td>0.147963</td>
                    <td>0.368906</td>
                    <td>0.396354</td>
                    <td>0.641536</td>
                    <td>0.249485</td>
                    <td>0.419698</td>
                    <td>0.469634</td>
                    <td>0.232669</td>
                    <td>0.250632</td>
                    <td>0.815911</td>
                    <td>1.000000</td>
                  </tr>
                </tbody>
              </table>
              </div>
              </div>
            </div>

            
              <div class="jp-Cell-outputWrapper">
                <div class="jp-OutputArea jp-Cell-outputArea">
                <div class="jp-OutputArea-child">
                    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[548]:</div>
                </div>

                <div class="jp-OutputArea-child">
                <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                <div class="jp-RenderedImage jp-OutputArea-output ">
<img src="images/chap2-sec3_5-final.png" loading="lazy" alt="" class="codecell" width="450" style="display: block; margin: 0 auto;">
                </div>
                </div>
                </div>
                </div>               

              </div>
            </div>

              </div>
          </div>
          <h1 class="chaptersubheading">Genres</h1>

      <div data-w-id="4c3e5d58-abc6-b169-6d22-4258b0304083" class="w-layout-grid sectiongrid">
        <a href="#" class="sectiontitle w-button">Initial wrangling and data generation</a>
        <div class="tooltip"><img src="images/graph.png" loading="lazy" id="w-node-_474e4a82-628a-a6fa-4213-2ce1923b9a16-ea071f39" alt="" class="icon"><span class="tooltiptext">Table</span>
        <img src="images/data.png" loading="lazy" id="w-node-_36c86509-8fba-0619-4910-a41280cce7b2-ea071f39" sizes="20px" srcset="images/data-p-500.png 500w, images/data.png 512w" alt="" class="icon"><span class="tooltiptext">Data</span></div>

      </div>
      <div data-w-id="26b14031-4d97-55d8-357d-183551f30ef2" style="display:none" class="sectioncode">

        <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
          <div class="jp-Cell-inputWrapper">
            <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
            </div>
            <div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
            </div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
            </div>
            </div>
            </div>
            </div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
              <div class="jp-Cell-inputWrapper">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>                <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[15]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;genre.json&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
  <span class="n">genres</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
  
        </div>
        </div>
        </div>

      </div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
        <div class="jp-Cell-inputWrapper">
        <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
        </div>
        <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[16]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
             <div class="CodeMirror cm-s-jupyter">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">imdb_score_per_genre</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">gross_per_genre</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">genre_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s1">&#39;genre_&#39;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">]</span>
<span class="n">df_genres</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">genre_columns</span><span class="p">]</span>
<span class="k">for</span> <span class="n">genre</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">genres</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">df_genres</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="n">value</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_genres</span><span class="p">])</span>
    <span class="n">df_specific_genre</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)][[</span><span class="s1">&#39;genres&#39;</span><span class="p">,</span> <span class="s1">&#39;idmb_score&#39;</span><span class="p">,</span> <span class="s1">&#39;worldwide_gross&#39;</span><span class="p">]]</span>
    <span class="n">imdb_score_per_genre</span><span class="p">[</span><span class="n">genre</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_specific_genre</span><span class="o">.</span><span class="n">idmb_score</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">gross_per_genre</span><span class="p">[</span><span class="n">genre</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_specific_genre</span><span class="o">.</span><span class="n">worldwide_gross</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">gross_per_genre</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">gross_per_genre</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notnull</span><span class="p">(</span><span class="n">v</span><span class="p">)}</span>
</pre></div>
        
             </div>
        </div>
        </div>
        </div>
        
        </div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
        <div class="jp-Cell-inputWrapper">
        <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
        </div>
        <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[17]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
             <div class="CodeMirror cm-s-jupyter">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">top_k</span> <span class="o">=</span> <span class="mi">5</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The </span><span class="si">{}</span><span class="s1"> best genres (in terms of IMDB score) are : </span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">top_k</span><span class="p">,</span> 
               <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> (</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">round</span><span class="p">(</span><span class="n">elem</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">imdb_score_per_genre</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)][:</span><span class="n">top_k</span><span class="p">])))</span>
        
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">The </span><span class="si">{}</span><span class="s1"> most prolific genres are  : </span><span class="se">\n</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">top_k</span><span class="p">,</span> 
               <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> (</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">millify</span><span class="p">(</span><span class="n">elem</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">gross_per_genre</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)][:</span><span class="n">top_k</span><span class="p">])))</span>
        </pre></div>
        
             </div>
        </div>
        </div>
        </div>
        
        <div class="jp-Cell-outputWrapper">
        <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
        </div>
        
        
        <div class="jp-OutputArea jp-Cell-outputArea">
        <div class="jp-OutputArea-child">
            
            <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
        
        
        <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
          <pre>
The 5 best genres (in terms of IMDB score) are : 
Biography (7.2)
History (7.1)
Drama (7.0)
Mystery (7.0)
War (7.0)
        
The 5 most prolific genres are  : 
Fantasy (457.7 M)
Adventure (454.7 M)
Animation (441.1 M)
Sci-Fi (433.0 M)
Musical (425.0 M)
      </pre>
        </div>
        </div>
        
        </div>
        
        </div>
        
        </div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
        <div class="jp-Cell-inputWrapper">
        <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
        </div>
        <div class="jp-InputArea jp-Cell-inputArea">
        <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[18]:</div>
        <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
             <div class="CodeMirror cm-s-jupyter">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">margin</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">width</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="n">margin</span><span class="p">)</span><span class="o">/</span><span class="mi">15</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
        
<span class="n">df_combine</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">gross_per_genre</span><span class="p">),</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">imdb_score_per_genre</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_combine</span> <span class="o">=</span> <span class="n">df_combine</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df_combine</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Gross&#39;</span><span class="p">,</span> <span class="s1">&#39;Score&#39;</span><span class="p">]</span>
        
<span class="n">df_combine</span><span class="o">.</span><span class="n">Gross</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df_combine</span><span class="o">.</span><span class="n">Score</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Worldwide Gross in M$ (green)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;IMDB Score (blue)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Comparaison between Worldwide Gross and IMDB score per genre&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">imdb_score_per_genre</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">rotation</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
        
             </div>
        </div>
        </div>
        </div>


        <div class="jp-Cell-outputWrapper">
          <div class="jp-OutputArea jp-Cell-outputArea">
          <div class="jp-OutputArea-child">
              <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[548]:</div>
          </div>

          <div class="jp-OutputArea-child">
          <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
          <div class="jp-RenderedImage jp-OutputArea-output ">
            <img src= "images/chap2-sec3_6-final.png" loading="lazy" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 3454px) 70vw, 2418px"  alt="" class="codecell">
          </div>
        </div>
        </div>
        </div>
        </div>
      </div>
    </div>
  </div>




            <!-- Chapter 3 section contents -->
            <div id="chapter-3" data-w-id="19e843bf-f930-2b20-1bc7-96f2b84ef89b" class="chapter chapter3">
              <h1 class="chapterheading">Chapter 03 - Modeling and Evaluation</h1>
              <h1 class="chaptersubheading">Prediction</h1>

              <div data-w-id="0f6d07da-ed32-c29c-e8ed-ca549ec08132" class="w-layout-grid sectiongrid">
                <a href="#" class="sectiontitle w-button">Summary Based transformation </a>
              </div>
              <div data-w-id="f72709b7-53a2-f799-19b5-0b33708bd1d1" style="display:none" class="sectioncode">
                <!-- <img src="images/chap3-sec1-1.png" loading="lazy" data-w-id="5d8c70e9-1207-845f-1ab9-dc44c02d6ce9" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 2805px) 69vw, 1936px" srcset="images/chap3-sec1-1-p-500.png 500w, images/chap3-sec1-1-p-800.png 800w, images/chap3-sec1-1-p-1080.png 1080w, images/chap3-sec1-1-p-1600.png 1600w, images/chap3-sec1-1.png 1936w" alt="">
                <img src="images/chap3-sec1-2.png" loading="lazy" data-w-id="8dabca59-54db-d770-e83b-7f411ff54c89" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 2797px) 69vw, 1930px" srcset="images/chap3-sec1-2-p-500.png 500w, images/chap3-sec1-2-p-800.png 800w, images/chap3-sec1-2-p-1080.png 1080w, images/chap3-sec1-2-p-1600.png 1600w, images/chap3-sec1-2.png 1930w" alt=""> -->
                <h2 class="chaptersubheading">Preprocessing</h2>

                <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
                  <div class="jp-Cell-inputWrapper">
                    <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                    </div>

                    <div class="jp-InputArea jp-Cell-inputArea">
                    <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[36]:</div>
                    <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">

                         <div class="CodeMirror cm-s-jupyter">
                    <div class=" highlight hl-ipython3"><pre><span></span><span class="c1">## Fill NA for genres</span>
<span class="n">df</span><span class="o">.</span><span class="n">genres</span>  <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">genres</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                    
<span class="c1">## Mean Inputer</span>
<span class="n">col_to_impute</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;actor_1_fb_likes&#39;</span><span class="p">,</span> <span class="s1">&#39;actor_2_fb_likes&#39;</span><span class="p">,</span> <span class="s1">&#39;actor_3_fb_likes&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;domestic_gross&#39;</span><span class="p">,</span> <span class="s1">&#39;duration_sec&#39;</span><span class="p">,</span> <span class="s1">&#39;num_critic_for_reviews&#39;</span><span class="p">,</span> <span class="s1">&#39;num_facebook_like&#39;</span><span class="p">,</span> <span class="s1">&#39;num_user_for_reviews&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;production_budget&#39;</span><span class="p">,</span> <span class="s1">&#39;total_cast_fb_likes&#39;</span><span class="p">,</span> <span class="s1">&#39;worldwide_gross&#39;</span><span class="p">,</span> <span class="s1">&#39;director_fb_likes&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">col_to_impute</span><span class="p">:</span>
    <span class="n">column</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">imp</span> <span class="o">=</span> <span class="n">Imputer</span><span class="p">(</span><span class="n">missing_values</span><span class="o">=</span><span class="s1">&#39;NaN&#39;</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">column</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
              </div>
                </div>
                </div>
                </div>
              </div>
            </div>

            

              <div data-w-id="9ba8e524-eefa-3365-37f3-c40f4b9efd66" class="w-layout-grid sectiongrid">
                <a href="#" class="sectiontitle w-button">Inspection Based transformation</a>
              </div>
              <div data-w-id="ec3754af-fb9e-c269-d783-a023beed4cf7" style="display:none" class="sectioncode">
                <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
                <div class="jp-Cell-inputWrapper">
                <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[37]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">numerical_cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span> <span class="o">!=</span> <span class="s1">&#39;object&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">not_wanted_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;title_year&#39;</span><span class="p">,</span> <span class="s1">&#39;storyline&#39;</span><span class="p">,</span> <span class="s1">&#39;release_date&#39;</span><span class="p">,</span> <span class="s1">&#39;image_urls&#39;</span><span class="p">,</span> <span class="s1">&#39;movie_title&#39;</span><span class="p">,</span> <span class="s1">&#39;keywords&#39;</span><span class="p">,</span> <span class="s1">&#39;movie_imdb_link&#39;</span><span class="p">,</span> <span class="s1">&#39;num_voted_users&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">genre_columns</span>
<span class="n">df</span><span class="o">.</span><span class="n">country</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">country</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">))</span>
<span class="n">df</span><span class="o">.</span><span class="n">language</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">language</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">))</span>
<span class="n">list_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="s1">&#39;genres&#39;</span><span class="p">,</span> <span class="s1">&#39;language&#39;</span><span class="p">]</span>
<span class="n">cols_to_transform</span> <span class="o">=</span> <span class="p">[</span><span class="n">cols</span> <span class="k">for</span> <span class="n">cols</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">cols</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">numerical_cols</span> <span class="o">+</span> <span class="n">not_wanted_cols</span> <span class="o">+</span> <span class="n">list_cols</span><span class="p">]</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">cols_to_transform</span><span class="p">]</span>
</pre></div>

                     </div>
                </div>
                </div>
                </div>
                
              </div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
                <div class="jp-Cell-inputWrapper">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[38]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">## Dummies for columns with list</span>
<span class="n">df_col_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">list_cols</span><span class="p">:</span>
    <span class="n">df_col_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_col_list</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
                
                     </div>
                </div>
                </div>
                </div>
                
              </div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
                <div class="jp-Cell-inputWrapper">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[39]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                     <div class="CodeMirror cm-s-jupyter">
                <div class=" highlight hl-ipython3"><pre><span></span><span class="c1">## Dummies for columns with string</span>
<span class="n">df_col_string</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">cols_to_transform</span><span class="p">)</span>
                </pre></div>
                
                     </div>
                </div>
                </div>
                </div>

                <!-- <img src="images/chap3-sec3-1.png" loading="lazy" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 3451px) 70vw, 2416px" srcset="images/chap3-sec3-1-p-500.png 500w, images/chap3-sec3-1-p-800.png 800w, images/chap3-sec3-1-p-1080.png 1080w, images/chap3-sec3-1-p-1600.png 1600w, images/chap3-sec3-1-p-2000.png 2000w, images/chap3-sec3-1.png 2416w" alt=""> -->
              </div>
            </div>

              <div data-w-id="f86c6878-97f5-63e4-c6d6-83558c897e98" class="w-layout-grid sectiongrid">
                <a href="#" class="sectiontitle w-button">Pre-Model Inspection of Data </a>
              </div>
              <div data-w-id="f72ec6cd-1983-9920-1c44-60d76bc1afe8" style="display:none" class="sectioncode">
                <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
                <div class="jp-Cell-inputWrapper">
                <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">IIn&nbsp;[40]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">[</span><span class="n">numerical_cols</span><span class="p">],</span> <span class="n">df_col_string</span><span class="p">,</span> <span class="n">df_col_list</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Columns dtypes :&#39;</span><span class="p">,</span> <span class="n">Counter</span><span class="p">(</span><span class="n">X_raw</span><span class="o">.</span><span class="n">dtypes</span><span class="p">))</span>
                </pre></div>

                     </div>
                </div>
                </div>
                </div>

                <div class="jp-Cell-outputWrapper">
                  <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                  </div>
                  
                  
                  <div class="jp-OutputArea jp-Cell-outputArea">
                  <div class="jp-OutputArea-child">
                      
                      <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                  
                  
                  <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
                  <pre>Columns dtypes : Counter({dtype(&#39;uint8&#39;): 13004, dtype(&#39;float64&#39;): 13, dtype(&#39;int64&#39;): 1})
                  </pre>
                  </div>
                  </div>
                  
                  </div>
                  
                  </div>
                  
                  </div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
                  <div class="jp-Cell-inputWrapper">
                  <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                  </div>
                  <div class="jp-InputArea jp-Cell-inputArea">
                  <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[41]:</div>
                  <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                       <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">X_raw</span><span class="o">.</span><span class="n">idmb_score</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X_raw</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;idmb_score&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                  </pre></div>
                  
                       </div>
                  </div>
                  </div>
                  </div>
                  
                  </div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
                  <div class="jp-Cell-inputWrapper">
                  <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                  </div>
                  <div class="jp-InputArea jp-Cell-inputArea">
                  <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[42]:</div>
                  <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                       <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
                      <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.20</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Train&#39;</span><span class="p">,</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">&#39;Test&#39;</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                  </pre></div>
                  
                       </div>
                  </div>
                  </div>
                  </div>
                  
                  <div class="jp-Cell-outputWrapper">
                  <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                  </div>
                  
                  
                  <div class="jp-OutputArea jp-Cell-outputArea">
                  <div class="jp-OutputArea-child">
                      
                      <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                  
                  
                  <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>Train (4089, 13017) Test (1023, 13017)
                  </pre>
                  </div>
                  </div>
                  
                  </div>
                  
                  </div>
                  
                  </div>
                </div>



              <div data-w-id="833e50bf-4c50-7528-6fc0-626f93914871" class="w-layout-grid sectiongrid">
                <a href="#" class="sectiontitle w-button">Generic Modeling</a>
              </div>
              <div data-w-id="fcac5519-e4a2-2d68-6008-8229c5d68f39" style="display:none" class="sectioncode">
                <h2 class="chaptersubheading">Choosing ML algorithm </h2>

                <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
                <div class="jp-Cell-inputWrapper">
                <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[696]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                     <div class="CodeMirror cm-s-jupyter">
                <div class=" highlight hl-ipython3"><pre><span></span><span class="n">gbr</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">GradientBoostingRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
                <span class="n">gbr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">Y_train</span><span class="p">)</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Training Score GradientBoosting: &quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">gbr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">Y_train</span><span class="p">)))</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Test Score GradientBoosting: &quot;</span> <span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">gbr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">Y_test</span><span class="p">)))</span>
                </pre></div>
                
                     </div>
                </div>
                </div>
                </div>
                
                <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                
                
                <div class="jp-OutputArea jp-Cell-outputArea">
                <div class="jp-OutputArea-child">
                    
                    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                
                
                <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>Training Score GradientBoosting:  0.965677058186
Test Score GradientBoosting:  0.445847202544
                </pre>
                </div>
                </div>
                
                </div>
                
                </div>
                
                </div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
                <div class="jp-Cell-inputWrapper">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[748]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                     <div class="CodeMirror cm-s-jupyter">
                <div class=" highlight hl-ipython3"><pre><span></span><span class="n">abr</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">AdaBoostRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
                <span class="n">abr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">Y_train</span><span class="p">)</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Training Score AdaBoostRegressor: &quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">abr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">Y_train</span><span class="p">)))</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Test Score AdaBoostRegressor: &quot;</span> <span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">abr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">Y_test</span><span class="p">)))</span>
                </pre></div>
                
                     </div>
                </div>
                </div>
                </div>
                
                <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                
                
                <div class="jp-OutputArea jp-Cell-outputArea">
                <div class="jp-OutputArea-child">
                    
                    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                
                
                <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>Training Score AdaBoostRegressor:  0.497750738605
Test Score AdaBoostRegressor:  0.450030379927
                </pre>
                </div>
                </div>
                
                </div>
                
                </div>
                
                </div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
                <div class="jp-Cell-inputWrapper">
                <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                </div>
                <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[765]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                     <div class="CodeMirror cm-s-jupyter">
                <div class=" highlight hl-ipython3"><pre><span></span><span class="n">rf</span><span class="o">=</span><span class="n">ensemble</span><span class="o">.</span><span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span> 
                <span class="n">rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Training Score RandomForest: &quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">rf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)))</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Cross Validation (10 fold) Score: &quot;</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">rf</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)))</span>
                </pre></div>
                
                     </div>
                </div>
                </div>
                </div>
                
                <div class="jp-Cell-outputWrapper">
                <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                </div>
                
                
                <div class="jp-OutputArea jp-Cell-outputArea">
                <div class="jp-OutputArea-child">
                    
                    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                
                
                <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>Training Score RandomForest:  0.933556405649
OOB Score RandomForest:  0.514455022206</pre>
                </div>
                </div>
                
                </div>
                
                </div>
                
                </div>
              </div>


    
              <h1 class="chaptersubheading">Tuning</h1>

              <div data-w-id="474e4a82-628a-a6fa-4213-2ce1923b9a12" class="w-layout-grid sectiongrid">
                <a href="#" class="sectiontitle w-button">Parameter Tuning</a>
                  

                    <div class="tooltip"><img src="images/graph.png" loading="lazy" id="w-node-_474e4a82-628a-a6fa-4213-2ce1923b9a16-ea071f39" alt="" class="icon"><span class="tooltiptext">Table</span></div>
                  
              </div>
              <div data-w-id="739b9486-aef0-2025-d031-723cdf9fa0ab" style="display:none" class="sectioncode">
                <h2 class="chaptersubheading">Cross Validation to choose n_estimators</h2>

                <div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
                <div class="jp-Cell-inputWrapper">
                <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[45]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rfs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">]:</span>
    <span class="n">rf</span><span class="o">=</span><span class="n">ensemble</span><span class="o">.</span><span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
    <span class="n">rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="n">rfs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">rf</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>

                     </div>
                </div>
                </div>
                </div>

                </div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
                <div class="jp-Cell-inputWrapper">
                <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[44]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_plot</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">rfs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">y_plot</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">rfs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
                
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span> <span class="n">y_plot</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Variation of the Cross Validation score in function of the number of estimators&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Number of estimators&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Cross Validation score&#39;</span><span class="p">)</span>
                </pre></div>

                     </div>
                </div>
                </div>
                </div>
                

                <div class="jp-Cell-outputWrapper">
                  <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                  </div>
                  
                  
                  <div class="jp-OutputArea jp-Cell-outputArea">
                  <div class="jp-OutputArea-child jp-OutputArea-executeResult">
                      
                      <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[44]:</div>
                  
                  
                  

                  <div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
                  <pre>&lt;matplotlib.text.Text at 0x111e98550&gt;</pre>
                  </div>
                  
                  </div>

                  <div class="jp-Cell-outputWrapper">
                    <div class="jp-OutputArea jp-Cell-outputArea">
                    <div class="jp-OutputArea-child">
                        <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[44]:</div>
                    </div>
          
                    <div class="jp-OutputArea-child">
                    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                    <div class="jp-RenderedImage jp-OutputArea-output ">
                      <img src="images/chap3-sec4_1-final.png" loading="lazy" alt="" class="codecell" width="450" style="display: block; margin: 0 auto;">
                    </div>

                  </div>
                  
                  </div>
                </div>

                  </div>
                  
                  </div>
                  <h2 class="chaptersubheading">Min leaf</h2>

                  <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
                  <div class="jp-Cell-inputWrapper">
                  <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                  </div>
                  <div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
                  </div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
                  <h4 id="Min-leaf">Min leaf<a class="anchor-link" href="#Min-leaf">&#182;</a></h4>
                  </div>
                  </div>
                  </div>
                  </div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
                  <div class="jp-Cell-inputWrapper">
                  <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
                  </div>
                  <div class="jp-InputArea jp-Cell-inputArea">
                  <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[66]:</div>
                  <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                       <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rfs2</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">4</span><span class="p">))):</span>
    <span class="n">rf</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">min_samples_leaf</span><span class="o">=</span><span class="n">k</span><span class="p">)</span> 
    <span class="n">rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="n">rfs2</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">oob_score_</span>
                      </pre></div>
                  
                       </div>
                  </div>
                  </div>
                  </div>

                  
                  
                  <div class="jp-Cell-outputWrapper">
                  <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
                  </div>
                  
                  
                  <div class="jp-OutputArea jp-Cell-outputArea">
                  <div class="jp-OutputArea-child">
                      
                      <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
                  
                  
                  <div class="jp-RenderedText jp-OutputArea-output" data-mime-type="application/vnd.jupyter.stderr">
                  <pre>100%|██████████| 9/9 [20:01&lt;00:00, 131.78s/it]
                  </pre>
                  </div>
                  </div>
                                    </pre>
                                    </div>
                                    </div>
                                    
                                    </div>
                                    
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
  <div class="jp-Cell-inputWrapper">
  <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
  </div>
  <div class="jp-InputArea jp-Cell-inputArea">
  <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[69]:</div>
  <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
        <div class="CodeMirror cm-s-jupyter">
  <div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_plot</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">rfs2</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">y_plot</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">rfs2</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span> <span class="n">y_plot</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Variation of the Cross Validation score in function of the minimum of sample per leaf&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Minimum of Samples per leaf&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;OOB score&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">

<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[69]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
<pre>&lt;matplotlib.text.Text at 0x13a3feac8&gt;</pre>
</div>

</div>



<div class="jp-Cell-outputWrapper">
  <div class="jp-OutputArea jp-Cell-outputArea">

  <div class="jp-OutputArea-child">
  <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
  <div class="jp-RenderedImage jp-OutputArea-output ">
    <img src="images/chap3-sec4_2.png" loading="lazy" alt="" class="codecell" width="450" style="display: block; margin: 0 auto;">
  </div>

</div>

</div>
</div>

</div>

</div>
<h2 class="chaptersubheading">max_features</h2>

<div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
  <div class="jp-Cell-inputWrapper">
  <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
  </div>
  <div class="jp-InputArea jp-Cell-inputArea">
  <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[61]:</div>
  <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
       <div class="CodeMirror cm-s-jupyter">
  <div class=" highlight hl-ipython3"><pre><span></span><span class="n">rfs2</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;log2&quot;</span><span class="p">,</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="s2">&quot;sqrt&quot;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]</span> <span class="p">:</span>
    <span class="n">rf</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">min_samples_leaf</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max_features</span> <span class="o">=</span> <span class="n">k</span><span class="p">)</span> 
    <span class="n">rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="n">rfs2</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">oob_score_</span>
    </pre></div>

  </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[62]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
  <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_plot</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rfs2</span><span class="p">))</span><span class="c1"># list(rfs2.keys())</span>
<span class="n">y_plot</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">rfs2</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rfs2</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span> <span class="n">y_plot</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Variation of the Cross Validation score in function of the minimum of sample per leaf&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Number of estimators&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Cross Validation score&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">

<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[62]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
  <pre>[0.2, 0.1, 0.3, &#39;log2&#39;, &#39;auto&#39;, &#39;sqrt&#39;]
  </pre>
  <pre>&lt;matplotlib.text.Text at 0x1113f8cf8&gt;</pre>
</div>

</div>



<div class="jp-Cell-outputWrapper">
  <div class="jp-OutputArea jp-Cell-outputArea">
  <div class="jp-OutputArea-child">
      <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[44]:</div>
  </div>

  <div class="jp-OutputArea-child">
  <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
  <div class="jp-RenderedImage jp-OutputArea-output ">
    <img src="images/chap3-sec4_3.png" loading="lazy" alt="" class="codecell" width="450" style="display: block; margin: 0 auto;">
  </div>

</div>

</div>
</div>

</div>

</div>   
</div>         
</div>  
</div>                  
               




              <div data-w-id="d8595479-17d9-3365-e2f3-43c2801c2a90" class="w-layout-grid sectiongrid">
                  <a href="#" class="sectiontitle w-button">Model refinement </a>
                  <div class="tooltip"><img src="images/graph.png" loading="lazy" id="w-node-_474e4a82-628a-a6fa-4213-2ce1923b9a16-ea071f39" alt="" class="icon"><span class="tooltiptext">Table</span></div>

              </div>

              <div data-w-id="a0605b1b-1c9d-abe9-f2d7-9d3a5f89bcba" style="display:none" class="sectioncode">
                <!-- <img src="images/chap3-sec10-1.png" loading="lazy" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 1860px) 65vw, 1209px" srcset="images/chap3-sec10-1-p-500.png 500w, images/chap3-sec10-1-p-800.png 800w, images/chap3-sec10-1-p-1080.png 1080w, images/chap3-sec10-1.png 1209w" alt=""> -->
                <h2 class="chaptersubheading">Learning</h2>

                <div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
                <div class="jp-Cell-inputWrapper">
                <div class="jp-InputArea jp-Cell-inputArea">
                <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[70]:</div>
                <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
                     <div class="CodeMirror cm-s-jupyter">
                <div class=" highlight hl-ipython3"><pre><span></span><span class="n">rf</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> 
<span class="n">rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Training Score RandomForest: &quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">rf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;OOB Score RandomForest: &quot;</span> <span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">rf</span><span class="o">.</span><span class="n">oob_score_</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">

<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>Training Score RandomForest:  0.676602290011
OOB Score RandomForest:  0.472550704314
</pre>
</div>
</div>

</div>
</div>
</div>

<h2 class="chaptersubheading">Most important features</h2>

<div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
  <div class="jp-Cell-inputWrapper">
  <div class="jp-InputArea jp-Cell-inputArea">
  <div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[70]:</div>
  <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
    <div class="CodeMirror cm-s-jupyter">
      <div class=" highlight hl-ipython3"><pre><span></span><span class="n">top_k</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">names</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">rf</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="n">top_k</span><span class="p">]]</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">rf</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="n">top_k</span><span class="p">]</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">names</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">values</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Most important features&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
  <div class="jp-OutputArea jp-Cell-outputArea">
  <div class="jp-OutputArea-child">
      <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[71]:</div>
  </div>

  <div class="jp-OutputArea-child">
  <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
  <div class="jp-RenderedImage jp-OutputArea-output ">
  <img src= "images/chap2-sec3_1-final.png" loading="lazy" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 3454px) 70vw, 2418px"  alt="" class="codecell">
</div>

</div>
</div>
</div>
</div>

</div>
<!-- The main Annotator script -->
<script src="pkg/html.annotator.js"></script>

<script>
var elem = document.querySelector("article");
var app = new annotator.App()
.include(annotator.ui.main, {
element: elem,
editorExtensions: [annotator.ui.colorPicker.editorExtension],
viewerExtensions: [
//annotator.ui.markdown.viewerExtension,
//annotator.ui.tags.viewerExtension,
],
})
.include(annotator.ui.filter.standalone)
.include(annotator.storage.localStore);
/*.include(annotator.storage.http, {
prefix: "https://arxiv-vanity-restful-api.herokuapp.com/api",
}); */
app.start().then(function () {
app.annotations.load({
uri: window.location.href,
});
});
</script>
<!-- <img src="images/chap5-sec7-1.png" loading="lazy" sizes="(max-width: 479px) 74vw, (max-width: 767px) 84vw, (max-width: 991px) 62vw, (max-width: 1855px) 65vw, 1206px" srcset="images/chap5-sec7-1-p-500.png 500w, images/chap5-sec7-1-p-800.png 800w, images/chap5-sec7-1-p-1080.png 1080w, images/chap5-sec7-1.png 1206w" alt=""> -->
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=6116d043a50c27b121071f38" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="js/webflow.js" type="text/javascript"></script>
<!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
</body>
</html>
